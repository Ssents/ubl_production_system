{% extends 'base.html' %}
{% load static %}


{% block title %}Pieces Form{% endblock  %}


{% block css_static %}
    <link rel="stylesheet" type="text/css" 
        href="{% static 'production/css/pieces_form.css' %}">
{% endblock  %}

{% block content %}
<div>
    <section class="production-pieces"></section>
        <p hidden>  
          coil id: <span id="coil-id">{{coil_id}}</span> 
        </p>
        <p hidden>
          order id: <span id="order-id">{{order_id}}</span>
        </p>
        <p hidden>
          machine id: <span id="machine_id">{{machine_id}}</span>
        </p>

        <div class="row ">
          <div class=" col-12 py-2 ">
              <div class="shadow p-3 mb-5 bg-white rounded machine-title">
                  <div class="row">
                      <h5 class="card-title col-6">{{machine.machine_name}} {{machine.machine_number}}</h5>
                      <h5 class="card-title col-6">{{machine.machine_serial_number}}</h5>
                      <h5 class="card-title col-6 home-url" hidden>{{home_url}}</h5>
                      <!-- <p class="card-text">Arnold </p> -->
                  </div>
                  <div class="row">
                      <h5 class="card-title col-6">{{order.order_number}}</h5>
                      <h5 class="card-title col-6">G{{order.order_gauge}} {{order.order_width}}
                          {{order.order_colour}} {{order.order_finish}}
                      </h5>
                      <!-- <p class="card-text">Arnold </p> -->
                  </div>
                  <div class="row">
                    <h5 class="card-title col-6">Coil Number</h5>
                    <h5 class="card-title col-6">{{coil.coil_number}}</h5>
                    <!-- <p class="card-text">Arnold </p> -->
                </div>
              </div>
          </div>
        </div>
      
        <form action=""  id="addPiece" class="row g-3 shadow p-3 mb-5 bg-white rounded order-form">
            <div class="py-3">
              <h3>Create Pieces</h3>
            </div>
            <!-- "{% url 'production:create-material-ajax' %}" -->
            {% csrf_token %}
            <input type="hidden" class="form-control" id="order-id" name="order_id" value="{{order_id}}">
      
            <div class="form-group row">
              <label for="new-length" class="col-sm-2 col-form-label"\>
                Piece length
              </label>
              <div class="col-sm-10">
                <input type="number" class="form-control" name="coil_number"
                 id="new-length" name="piece-length" step="0.01">
              </div>
            </div>
            
            <div class="form-group row">
              <label for="new-prime" class="col-sm-2 col-form-label">
                Prime pieces
              </label>
              <div class="col-sm-10">
                <input type="number" class="form-control" id="new-prime" 
                  name="prime-pieces">
              </div>
            </div>
            
            <div class="form-group row">
              <label for="new-reject" class="col-sm-2 col-form-label">Rejects pieces</label>
              <div class="col-sm-10">
                <input type="number" class="form-control" 
                  id="new-reject" name="rejects-pieces">
              </div>
            </div>
      
      
            <div class="form-row col-md-12 p-2">
              <div class="col-md-6 py-1 back-button">
                <a href ="{% url 'maintenance:dashboard' machine_id %}">
                  <button type="button" class="btn col-md-12 " 
                    data-toggle="button" aria-pressed="false" 
                    id="submit-order">
                    Back to dashboard
                  </button>
                </a>
              </div>
      
              <div class="col-md-6 py-1 add-new submit-button">
                <button type="submit" class="btn col-md-12" 
                  data-toggle="button" aria-pressed="false" 
                  id="submit-new-pieces">
                  Save and Continue
                </button>
              </div>
            </div>
      
        </form>
      
      


        <table class="table table-hover myDataTable" id="pieces-table">
          <thead>
            <tr>
              <th scope="col" id="length-row">Piece length</th>
              <th scope="col" id="prime-row">Prime pieces</th>
              <th scope="col" id="rejects-row">Rejects pieces</th>
              <th scope="col" id="options-row">Options</th>
            </tr>
          </thead>
          
          <tbody >
            {% for piece in pieces %}
              <tr id="{{piece.id}}">
                <td name="piece_length" class="piece-length">{{piece.piece_length}}</td>
                <td name="prime_pieces" class="prime-pieces">{{piece.prime_pieces}}</td>
                <td name="reject_pieces" class="reject-pieces">{{piece.reject_pieces}}</td>
                <td>
                  <div class="row">
                    <button type="button" class="btn btn-primary col-md-6 updatePieces" 
                      data-bs-toggle="modal" data-bs-target="#editPiecesForm">
                        Edit
                    </button>
                    <button type="button" class="btn btn-danger col-md-6 deletePieces"
                      data-bs-toggle="modal" data-bs-target="#deletePiecesForm">
                      Delete
                    </button>
                  </div>
                
                </td>	      
              </tr>       
            {% endfor %}

          </tbody>

          <tfoot>
              <tr>
              <td colspan="2">Total running meters</td>
              <td colspan="2" id="total-running-meters"> 236.45</td>

            </tr>
            <tr>
              <td colspan="2">Total tonage</td>
              <td colspan="2" id="total-tonage">1.536</td>
            </tr>

          </tfoot>
        </table>
    </section>

</div>

<div class="modal fade" id="editPiecesForm" data-bs-backdrop="static" 
  data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" 
  aria-hidden="true">
  <div class="modal-dialog">
      <div class="modal-content modal-edit-pieces">
          <div class="modal-header">
              <h5 class="modal-title" id="staticBackdropLabel">
                  Edit Pieces
              </h5>
              <button type="button" class="btn-close" 
                  data-bs-dismiss="modal" aria-label="Close">
              </button>
          </div>
          <div class="modal-body">
              <form class="row g-3">
                <div class="col-md-12">
                    <label for="inputPieceLength" class="form-label">Piece Length</label>
                    <input type="number" step="0.01" class="form-control" id="inputPieceLength">
                </div>
  
                <div class="col-lg-12">
                  <label for="inputPrimePieces" class="form-label">Prime pieces</label>
                  <input type="number" class="form-control" id="inputPrimePieces">
                </div>
  
                <div class="col-md-12">
                  <label for="inputRejectPieces" class="form-label">Reject pieces</label>
                  <input type="number" class="form-control" id="inputRejectPieces">
                </div>


          </div>
          <div class="modal-footer">
          <button type="button" class="btn btn-secondary bg-danger" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="confirmEditPieces">Save</button>
          </div>
        </form>
        </div>
  </div>
</div>

<!-- Modal Delete Alert-->
<div class="modal fade" id="deletePiecesForm" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="staticBackdropLabel">Delete Piece</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        Are you sure you want to delete piece?
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary bg-danger" data-bs-dismiss="modal">No</button>
        <button type="button" class="btn btn-primary" id="confirmDelete">Yes</button>
      </div>
    </div>
  </div>
</div>



{% endblock  %}
    



{% block javascript_block %}
  <script type="text/javascript" src="{% static 'production/js/pieces_form.js' %}"></script> 
{% endblock  %}
  